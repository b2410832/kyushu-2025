<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>2025 北九州之旅</title>
    
    <!-- 引入 React -->
    <script crossorigin src="https://unpkg.com/react@18/umd/react.development.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>
    
    <!-- 引入 Babel 用來解析 JSX -->
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    
    <!-- 引入 Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>

    <!-- 部署 manifest -->
    <link rel="manifest" href="manifest.json" />
    
    <!-- 設定字型 -->
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Noto+Sans+TC:wght@300;400;500;700&display=swap');
        body {
            font-family: 'Noto Sans TC', sans-serif;
            background-color: #f5f5f4;
            -webkit-tap-highlight-color: transparent;
        }
        /* 自定義動畫 */
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(5px); }
            to { opacity: 1; transform: translateY(0); }
        }
        .animate-fade-in {
            animation: fadeIn 0.3s ease-in-out;
        }
        /* iOS 安全區域設定 */
        .pb-safe {
            padding-bottom: env(safe-area-inset-bottom, 20px);
        }
    </style>
</head>
<body>
    <div id="root"></div>

    <script type="text/babel">
        const { useState, useEffect, useMemo } = React;

        // --- 簡易圖標組件 (SVG) ---
        // 為了不依賴外部 npm 套件，我們直接將圖標寫成組件
        const IconBase = ({ children, size = 20, className = "" }) => (
            <svg xmlns="http://www.w3.org/2000/svg" width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}>{children}</svg>
        );

        const Icons = {
            Navigation: (p) => <IconBase {...p}><polygon points="3 11 22 2 13 21 11 13 3 11"/></IconBase>,
            MapPin: (p) => <IconBase {...p}><path d="M21 10c0 7-9 13-9 13s-9-6-9-13a9 9 0 0 1 18 0z"/><circle cx="12" cy="10" r="3"/></IconBase>,
            Utensils: (p) => <IconBase {...p}><path d="M3 2v7c0 1.1.9 2 2 2h4a2 2 0 0 0 2-2V2"/><path d="M7 2v20"/><path d="M21 15V2v0a5 5 0 0 0-5 5v6c0 1.1.9 2 2 2h3Zm0 0v7"/></IconBase>,
            Train: (p) => <IconBase {...p}><rect width="16" height="16" x="4" y="4" rx="2"/><path d="M4 10h16"/><path d="M12 4v8"/><path d="m8 22 1-6"/><path d="m16 22-1-6"/><circle cx="8" cy="16" r="1"/><circle cx="16" cy="16" r="1"/></IconBase>,
            Hotel: (p) => <IconBase {...p}><path d="M18 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V4a2 2 0 0 0-2-2Z"/><polyline points="7 2 7 22"/><polyline points="17 2 17 22"/><line x1="2" x2="22" y1="12" y2="12"/><line x1="2" x2="22" y1="18" y2="18"/></IconBase>,
            Calendar: (p) => <IconBase {...p}><rect width="18" height="18" x="3" y="4" rx="2" ry="2"/><line x1="16" x2="16" y1="2" y2="6"/><line x1="8" x2="8" y1="2" y2="6"/><line x1="3" x2="21" y1="10" y2="10"/></IconBase>,
            CloudSun: (p) => <IconBase {...p}><path d="M12 2v2"/><path d="m4.93 4.93 1.41 1.41"/><path d="M20 12h2"/><path d="m19.07 4.93-1.41 1.41"/><path d="M15.947 12.65a4 4 0 0 0-5.925-4.128"/><path d="M13 22H7a5 5 0 1 1 4.9-6H13a3 3 0 0 1 0 6Z"/></IconBase>,
            Info: (p) => <IconBase {...p}><circle cx="12" cy="12" r="10"/><path d="M12 16v-4"/><path d="M12 8h.01"/></IconBase>,
            Phone: (p) => <IconBase {...p}><path d="M22 16.92v3a2 2 0 0 1-2.18 2 19.79 19.79 0 0 1-8.63-3.07 19.5 19.5 0 0 1-6-6 19.79 19.79 0 0 1-3.07-8.67A2 2 0 0 1 4.11 2h3a2 2 0 0 1 2 1.72 12.84 12.84 0 0 0 .7 2.81 2 2 0 0 1-.45 2.11L8.09 9.91a16 16 0 0 0 6 6l1.27-1.27a2 2 0 0 1 2.11-.45 12.84 12.84 0 0 0 2.81.7A2 2 0 0 1 22 16.92z"/></IconBase>,
            Wallet: (p) => <IconBase {...p}><path d="M21 12V7H5a2 2 0 0 1 0-4h14v4"/><path d="M3 5v14a2 2 0 0 0 2 2h16v-5"/><path d="M18 12a2 2 0 0 0 0 4h4v-4Z"/></IconBase>,
            ChevronDown: (p) => <IconBase {...p}><path d="m6 9 6 6 6-6"/></IconBase>,
            ChevronUp: (p) => <IconBase {...p}><path d="m18 15-6-6-6 6"/></IconBase>,
            Plane: (p) => <IconBase {...p}><path d="M2 12h5"/><path d="M13 12h9"/><path d="M4 17V7l15 5Z"/></IconBase>,
            Plus: (p) => <IconBase {...p}><path d="M5 12h14"/><path d="M12 5v14"/></IconBase>,
            Trash2: (p) => <IconBase {...p}><path d="M3 6h18"/><path d="M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6"/><path d="M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2"/><line x1="10" x2="10" y1="11" y2="17"/><line x1="14" x2="14" y1="11" y2="17"/></IconBase>,
            Snow: (p) => <IconBase {...p}><path d="M2 12h20"/><path d="M12 2v20"/><path d="m20 2-5 5"/><path d="m4 2 5 5"/><path d="m20 22-5-5"/><path d="m4 22 5-5"/></IconBase>
        };

        // --- Data ---
        const tripData = {
          meta: {
            title: "2025 北九州冬季漫遊",
            dates: "2025.12.24 - 12.31",
            travelers: "爸、夫、丹、R"
          },
          days: [
            {
              id: 1,
              date: "12/24 (三)",
              location: "台北 → 福岡",
              weather: { temp: "8°C - 13°C", icon: "CloudSun", desc: "晴時多雲" },
              items: [
                {
                  type: "transport",
                  time: "14:45 - 18:00",
                  title: "台北 T1 → 福岡 I",
                  desc: "星宇航空 JX840 (2小時15分)",
                  highlight: "去程航班",
                  tags: ["交通"],
                  nav: "桃園機場第一航廈"
                },
                {
                  type: "transport",
                  title: "福岡機場 → 博多車站",
                  desc: "搭機場免費接駁巴士至國內線航廈，再轉乘地鐵 5 分鐘抵達「博多站」或搭乘計程車約 15 分鐘直達飯店",
                  tags: ["交通"],
                  image: "ticket-machine.png",
                  imageDesc: "車站售票機點擊「Read QR code」> 掃描預訂確認郵件中的 QR code > 在 Select payment method 選擇「Paid」> 輸入 11 位取票編號 > 點擊「Issue」後每位乘客將獲得兩張車票：1張基本票+1張特快列車票。",
                  tips: "抵達博多車站後記得換取 JR 車票 @Janet @Rose。",
                  nav: "博多車站"
                },
                {
                  type: "hotel",
                  title: "福岡日航飯店",
                  desc: "入住：15:00 / 退房：11:00",
                  tips: "預訂人 @Janet、Klook @Rose。",
                  tags: ["住宿"],
                  nav: "福岡日航飯店",
                  image: "fukuoka-nikko.jpg",
                },
                {
                  type: "food",
                  title: "晚餐：LOPIA 超市熟食 或 博多拉麵",
                  tags: ["餐食"],
                  image: "christmas-market.webp",
                  imageDesc: "博多聖誕市集「CHRISTMAS MARKET in 光の街・博多」日期：2025/11/1~12/25，地點：JR 博多站前廣場，開放時間：【平日】16:45-23:00，【週末及假日】12:00-23:00，入場費：免費。",
                  tips: "拉麵推薦：ShinShin(清爽)、gaga(清爽)、大砲(濃厚)、麵屋兼虎(沾麵)。",
                },
              ]
            },
            {
              id: 2,
              date: "12/25 (四)",
              location: "福岡 → 由布院",
              weather: { temp: "2°C - 10°C", icon: "CloudSun", desc: "山區較冷" },
              items: [
                {
                  type: "food",
                  time: "08:00",
                  title: "早餐：Dacomecca",
                  desc: "福岡人氣麵包店",
                  tags: ["必吃美食", "餐食"],
                  tips: "營業時間：週一至週日 07:00–19:00。推薦：明太子法棍、炭烤香腸麵包。",
                  nav: "Dacomecca",
                  image: "dacomecca.jpg",
                  imageDesc: "DACOMECCA 是位於福岡市中心博多區近博多口 KITTE 博多的超人氣麵包店， 為 AMAM DACOTAN 和 I’m donut? 甜甜圈專門店的姐妹店，店內每天有超過40種以上的三明治麵包、點心，一早就吸引了很多人來現場購買，近傍晚就會賣完打烊。",
                },
                {
                  type: "transport",
                  time: "10:11 - 12:32",
                  title: "博多 → 由布院",
                  desc: "JR 由布院之森 3 號",
                  tags: ["需預約", "必搭人氣觀光列車", "交通"],
                  tips: "列車內提供的便當和一些甜點需要提前預訂，2號車廂有餐車櫃檯。",
                  nav: "Yufuin Station",
                  image: "yufuin_no_mori_express.jpg",
                  imageDesc: "「由布院之森」外觀為全綠色列車，車廂內部使用大量木頭設計，從地板、桌子到吧台，都能感受滿滿森林氛圍，最大亮點為頭尾兩節車廂的車頭，大面積玻璃窗，讓遊客乘坐時可欣賞外面的山景。列車上的販售部也是不可錯過的亮點，提供使用當地食材製作、每季更換菜色的「由布院之森限定便當」；Milch 起司蛋糕、浮羽綜合水果三明治等「大分縣特色甜點」，「由布院之森紀念商品」與「列車限定飲品」等多款特色商品。",
                },
                {
                  type: "sight",
                  title: "逛車站周邊 或 飯店周邊",
                  desc: "車站寄放行李 或 聯絡飯店接駁",
                  nav: "Yufuin Station"
                },
                {
                  type: "hotel",
                  title: "山莊無量塔",
                  desc: "入住：15:00 / 退房：11:00",
                  tips: "預訂人：官網 @Janet，到店付款。",
                  tags: ["必住由布院御三家", "住宿"],
                  image: "sansou-murata.jpg",
                  imageDesc: "佇立於大分由布院的溫泉旅館，融合藝術、美食與靜謐空間，融合懷舊與創新，展現日本原始風景的元素，帶來令人心醉的時光。融合懷舊與創新，展現日本原始風景的元素，帶來令人心醉的時光。位於寧靜的鳥越地區，館內設有溫泉旅館、美術館 artegio、Tan’s Bar、thétheo 咖啡館、theomurata 巧克力與不生庵蕎麥麵。",
                  nav: "Sansou Murata"
                },
                {
                  type: "food",
                  title: "晚餐：山莊無量塔",
                  desc: "頂級日式懷石料理",
                  tags: ["餐食"],
                  nav: "Sansou Murata"
                }
              ]
            },
            {
              id: 3,
              date: "12/26 (五)",
              location: "由布院",
              weather: { temp: "0°C - 8°C", icon: "CloudSun", desc: "早晚溫差大" },
              items: [
                {
                  type: "sight",
                  time: "7:30",
                  title: "金鱗湖",
                  desc: "秋冬限定夢幻晨霧",
                  tags: ["景點"],
                  tips: "每年10月至翌年3月是拍攝金鱗湖晨霧的最佳季節，建議在早上6:30至8:00之間取景，日出前後的霧氣最濃。飯店出發步行約20分鐘。",
                  image: "kinrin-lake.jpg",
                  imageDesc: "西元1884年，知名儒家學者「毛利空桑」造訪當地時，因見湖中魚隻鱗片在夕陽映照下反射出耀眼如黃金的光芒，便為此湖另取了「金鱗湖」之名，並一路沿用至今。金鱗湖最為人所知的就是如夢似幻的「晨霧」美景，由於湖水受到地底湧出的溫泉水加熱，故即便是寒冬時水溫也能維持在攝氏13至15度，當早晨氣溫偏低時便能看到湖面飄起渺渺白煙，彷彿為四周景色上了一層灰白色濾鏡，展現令人陶醉不已的朦朧美。金鱗湖晨霧景緻的最佳拍攝時間，為每年秋冬的日出時到早上8點左右，白天氣溫升高後晨霧就會自然消失。",
                  nav: "金鱗湖"
                },
                {
                  type: "food",
                  time: "",
                  title: "早餐：山莊無量塔",
                  desc: "頂級日式懷石料理",
                  tags: ["餐食"],
                  nav: "Sansou Murata"
                },
                {
                  type: "transport",
                  time: "11:00",
                  title: "退房前往壽花之庄寄放行李",
                  desc: "搭山莊無量塔飯店接駁車約 10 分鐘",
                  tags: ["交通"],
                  nav: "Kotobuki Hananosho"
                },
                {
                  type: "sight",
                  time: "",
                  title: "湯之坪街道散策",
                  desc: "由布院商店街",
                  tags: ["景點"],
                  image: "yufuinocho.jpg",
                  imageDesc: "湯之坪街道是由布院最熱鬧的商業區，這條充滿藝術氣息的街道綿延約1.5公里，沿著金鱗湖延伸，每年吸引超過400萬遊客前來享受悠閒的溫泉小鎮風情與購物樂趣。",
                  tips: "多數店家的營業時間約為上午9點至下午5點左右。推薦：B-speak 蛋糕捲、花麴菊家布丁銅鑼燒、Milch布丁 半熟起司蛋糕、吉吾柚子胡椒炸雞、Snoopy茶屋。",
                  nav: "湯之坪街道"
                },
                {
                  type: "sight",
                  title: "由布院花卉村、金鱗湖",
                  desc: "英式鄉村小型主題公園",
                  tags: ["景點"],
                  image: "floral-village.jpg",
                  imageDesc: "以英國科茲窩爾德（Cotswold）村落為設計靈感，結合了歐式風格的建築與細緻的景觀設計，打造出一座童話般的迷你村落。",
                  tips: "魔女宅急便主題店、愛麗絲夢遊仙境、吉卜力商店、貓頭鷹之森。可於金鱗湖畔咖啡廳休息：Cafe La Ruche、茶房 天井棧敷。",
                  nav: "由布院花卉村"
                },
                {
                  type: "sight",
                  title: "COMICO ART MUSEUM",
                  desc: "隈研吾設計美術館",
                  tags: ["景點"],
                  tips: "展出草間彌生、村上隆、奈良美智作品，館外的白色大狗雕塑「Your Dog」是熱門拍照景點。營業時間：9:30-17:00（毎週三休館）。",
                  nav: "COMICO ART MUSEUM YUFUIN"
                },
                {
                  type: "hotel",
                  time: "17:00",
                  title: "由布院 壽花之庄",
                  desc: "入住：14:00（最晚18:00）/ 退房：10:00",
                  tags: ["住宿"],
                  image: "hananosho.jpg",
                  tips: "預訂人：@Janet，到店付款。",
                  nav: "Kotobuki Hananosho"
                },
                {
                  type: "food",
                  time: "",
                  title: "晚餐：壽花之庄",
                  desc: "黑毛和牛牛排日式會席料理",
                  tags: ["餐食"],
                  nav: "Kotobuki Hananosho"
                },
              ]
            },
            {
              id: 4,
              date: "12/27 (六)",
              location: "由布院 → 阿蘇 → 黑川溫泉",
              weather: { temp: "-2°C - 5°C", icon: "Snow", desc: "可能降雪" },
              items: [
                {
                  type: "food",
                  time: "7:30",
                  title: "早餐：壽花之庄",
                  desc: "日式鄉土料理",
                  tags: ["餐食"],
                  nav: "Kotobuki Hananosho"
                },
                {
                  type: "transport",
                  time: "09:10 - 11:33",
                  title: "由布院站前巴士中心 → 阿蘇",
                  desc: "九州產交高速巴士",
                  tags: ["需預約", "交通"],
                  tips: "預訂人：@Janet，上車前出示郵件並告知工作人員預約者姓名。",
                  nav: "Yufuin Station Bus Terminal"
                },
                {
                  type: "transport",
                  time: "12:00",
                  title: "阿蘇站前 Toyota 租車",
                  desc: "出發時間：2025/12/27 12:00 / 還車時間：2025/12/18 15:30",
                  tags: ["需預約", "交通"],
                  tips: "預訂人：@Janet。",
                  nav: "阿蘇站前toyota租車"
                },
                {
                  type: "food",
                  title: "午餐：赤牛丼",
                  desc: "阿蘇名物",
                  tips: "推薦：MESHI NO YAMAICHI、IMAKIN食堂、Iwasaki、Hanabishi(炸)、山康，皆需預留排隊時間。",
                  tags: ["必吃美食", "餐食"],
                  image: "red-beef-don.jpg",
                  imageDesc: "阿蘇的特產「赤牛」是在阿蘇火山口形成的草原上種植的。一種棕色毛的日本品種，紅肉鬆軟適度，味道濃鬱。其味道香甜、脂肪含量低、質地輕盈，因健康美味而受到關注。",
                  nav: "MESHI NO YAMAICHI"
                },
                {
                  type: "hotel",
                  time: "15:00",
                  title: "黑川溫泉 奧之湯",
                  desc: "入住：15:00（最晚 17:00）/ 退房：10:00 \n 提供可容納最多 25 輛車的免費停車場",
                  tips: "預訂人：Booking.com @Janet。可走路10分鐘至黑川溫泉街逛逛。",
                  tags: ["住宿"],
                  image: "okunoyu.jpg",
                  imageDesc: "本館佇立在流經整個黑川溫泉的田之原川上游，包括露天浴池和家庭浴池在內有 9 種不同的泡湯池，分別設在本館、新館和別屋周邊，另外還有黑川唯一的蒸煮場和岩盤浴、溫泉溫水游泳池、三溫暖等各種設施。泉質：氯化鈉硫酸鹽泉（弱酸性低張性高溫泉）。",
                  nav: "Kurokawa Onsen Okunoyu"
                },
                {
                  type: "food",
                  time: "",
                  title: "晚餐：黑川溫泉 奧之湯",
                  desc: "當地食材烹調的鄉村風味宴席料理",
                  tags: ["餐食"],
                  nav: "Kurokawa Onsen Okunoyu"
                },
                {
                  type: "sight",
                  title: "黑川溫泉「湯明」",
                  desc: "冬季限定點燈活動",
                  tips: "時間：2025/12/20~2026/3/31，每日17:30~21:30，最佳地點：丸鈴橋。",
                  tags: ["景點"],
                  image: "kurokawa.jpeg",
                  imageDesc: "黑川溫泉為協力於維持山嶺的環境，將被放置的竹林加以利用而開始了湯明這項活動。成長速度相當快的竹子，若沒有持續管理可是會造成山裡的威脅。「湯明」則作為環境維持・管理活動的一環所舉辦，利用竹子做成燈籠和其他作品，讓黑川溫泉的街道優雅溫暖，迎接前來到訪的旅客們。有著各式各樣大大小小的竹燈籠和其他作品，活動結束後會將這些竹子拿去平野台的炭窯再生成竹炭，粉碎後的東西可以做成肥料和地面軟墊等再利用。以及於湯明所獲得的收益將於環境維持活動中派上用場，保護黑川溫泉的美麗環境。",
                  nav: "丸鈴橋"
                }
              ]
            },
            {
              id: 5,
              date: "12/28 (日)",
              location: "黑川溫泉 → 阿蘇 → 熊本",
              weather: { temp: "5°C - 12°C", icon: "CloudSun", desc: "多雲時晴" },
              items: [
                {
                  type: "food",
                  time: "8:30",
                  title: "早餐：黑川溫泉 奧之湯",
                  desc: "當地食材烹調的鄉村風味宴席料理",
                  tags: ["餐食"],
                  nav: "Kurokawa Onsen Okunoyu"
                },
                // {
                //   type: "sight",
                //   time: "9:30",
                //   desc: "黑川溫泉出發約 1 小時",
                //   title: "自駕前往上色見熊野座神社",
                //   image: "shrine.jpg",
                //   imageDesc: "上色見熊野座神社位於熊本縣高森町，是一處被原始森林與千年杉木圍繞的靜謐聖地。沿著石階而上，約兩百多階梯之後，便可抵達擁有濃厚神秘氛圍的本殿。神社的「穿石」岩壁中有一道天然的巨大圓洞，相傳是神靈顯靈的象徵，也成為神社最具代表性的奇景之一。不只是當地人心中的信仰據點，這座神社也因與動畫《螢火之森》場景神似，而成為許多粉絲默默造訪的夢幻景點。",
                //   tags: ["景點"],
                //   nav: "上色見熊野座神社",
                // },
                // {
                //   type: "food",
                //   title: "午餐：赤牛專門店 山康 やま康",
                //   tags: ["餐食"],
                //   desc: "超人氣赤牛丼排隊名店",
                //   image: "yamayasu.jpg",
                //   imageDesc: "每日限量牛排。",
                //   tips: "10:00開始登記領號碼牌。營業時間：週四到週日 11:00-14:00，售完為止。",
                //   nav: "山康"
                // },
                {
                  type: "transport",
                  time: "10:00",
                  title: "自駕前往阿蘇火山口",
                  desc: "飯店出發約 1 小時",
                  tags: ["交通"],
                  nav: "阿蘇中岳火山口"
                },
                {
                  type: "sight",
                  time: "11:00",
                  title: "阿蘇中岳火山口",
                  tips: "視火山氣體濃度開放: <a class='underline' target='_blank'  href='https://www.aso-volcano.jp/'>https://www.aso-volcano.jp/</a>。阿蘇山公園道路冬季期間：12月1日~3月19日 AM9:00-PM4:30 ※PM5:00閉門",
                  tags: ["景點"],
                  image: "volcano.avif",
                  nav: "阿蘇中岳火山口"
                },
                {
                  type: "sight",
                  title: "草千里之濱",
                  desc: "草千里之濱、草千里展望所、草千里咖啡焙煎所",
                  tips: "可於草千里咖啡焙煎所短暫休憩，營業時間：10:00-17:00。二樓有景觀餐廳新草千里，營業時間：11:00-15:00。",
                  tags: ["景點"],
                  image: "kusa-senrigahama.webp",
                  imageDesc: "在海拔約1,100公尺、佔地785,000平方公尺的「草千里之濱」可以看到悠然漫步的馬群，並眺望阿蘇中岳噴著白色煙霧的生動風光。夏天綠意盎然的光景，到了冬季會幻化為銀白色的世界，運氣好也有機會欣賞到樹冰景緻。來到草千里之濱除了可以散步欣賞美景之外，也可以在一望無際的大草原體驗騎馬。草千里周邊還有許多特色咖啡廳與餐廳，可以一邊眺望草原壯麗風光，一邊享受美食，享受自由自在的時光。",
                  nav: "草千里之濱"
                },
                {
                  type: "transport",
                  time: "15:30",
                  title: "阿蘇站前 Toyota 還車",
                  desc: "還車時間：2025/12/18 15:30",
                  tags: ["交通"],
                  nav: "阿蘇站前toyota租車"
                },
                {
                  type: "transport",
                  time: "15:56 - 17:08",
                  title: "阿蘇 → 熊本",
                  desc: "JR 阿蘇男孩號 (Aso Boy!)",
                  tags: ["需預約", "必搭人氣觀光列車", "交通"],
                  image: "asoboy.jpg",
                  imageDesc: "全車都是『小黑』狗狗圖案，3號車廂設有家庭車廂、親子坐席、遊樂場、咖啡館等。",
                  tips: "預訂人: Klook @Rose。",
                  nav: "熊本車站"
                },
                {
                  type: "hotel",
                  title: "Ref Kumamoto by VESSEL HOTELS",
                  desc: "入住：14:00 / 退房：11:00",
                  tips: "預訂人：官網 @Janet、易遊網 @Rose。熊本車站搭乘計程車約10分鐘直達飯店。",
                  tags: ["住宿"],
                  nav: "Ref Kumamoto by VESSEL HOTELS"
                },
                {
                  type: "food",
                  title: "晚餐：燒肉 Sudo 或 勝烈亭豬排",
                  desc: "",
                  tips: "『勝烈亭』是米其林推薦豬排，六白黑豚超厚切。『燒肉Sudo』有專人代烤，熊本最強燒肉之一。",
                  tags: ["餐食"],
                  nav: "Katsuretsu Tei Shinshigai"
                },
              ]
            },
            {
              id: 6,
              date: "12/29 (一)",
              location: "熊本 → 福岡",
              weather: { temp: "7°C - 14°C", icon: "CloudSun", desc: "晴朗" },
              items: [
                {
                  type: "transport",
                  time: "11:42 - 12:21",
                  title: "熊本 → 博多",
                  desc: "九州新幹線",
                  tags: ["需預約", "交通"],
                  nav: "Kumamoto Station"
                },
                {
                  type: "hotel",
                  title: "福岡日航飯店",
                  desc: "入住：15:00 / 退房：11:00",
                  tips: "預訂人：Klook @Janet。",
                  tags: ["住宿"],
                  nav: "福岡日航飯店"
                },
                {
                  type: "food",
                  title: "午餐：福岡自理",
                  desc: "",
                  tags: ["餐食"],
                },
                {
                  type: "food",
                  time: "19:30",
                  title: "晚餐：博多牛腸鍋前田屋(今泉店)",
                  desc: "博多名物牛腸鍋(Motsunabe)",
                  tags: ["需預約", "必吃美食", "餐食"],
                  tips: "預訂人：@Janet。推薦：味噌口味、鯖魚生魚片、波浪麵。",
                  image: "motsunabe-maedaya.webp",
                  imageDesc: "",
                  nav: "博多もつ鍋前田屋 今泉店"
                },
              ]
            },
            {
              id: 7,
              date: "12/30 (二)",
              location: "福岡",
              weather: { temp: "6°C - 12°C", icon: "CloudSun", desc: "乾冷" },
              items: [
                {
                  type: "food",
                  time: "8:00",
                  title: "早餐：Pain Stock 天神店",
                  desc: "超人氣排隊麵包名店",
                  tags: ["必吃排隊美食", "餐食"],
                  tips: "明太子麵包需至櫃檯點餐，販售半條或一條。可附近公園享用或內用。推薦：明太子麵包、開心果甜甜圈、白巧克力葡萄千層、咖啡。營業時間：8:00–19:00。",
                  image: "pain-stock.jpg",
                  imageDesc: "",
                  nav: "Pain Stock Tenjin"
                },
                {
                  type: "food",
                  time: "12:00",
                  title: "午餐：鮨と天草大王 天音",
                  desc: "藥院 Omakase",
                  tags: ["需預約", "Tabelog 2025百名店", "餐食"],
                  image: "sushi.jpg",
                  tips: "預訂人: @Janet。",
                  nav: "鮨と天草大王 天音"
                },
                {
                  type: "sight",
                  title: "福岡市區散策",
                  desc: "天神地下街、百貨公司",
                  tags: ["景點"],
                  nav: "Tenjin Underground Shopping Center"
                },
                {
                  type: "hotel",
                  title: "福岡日航飯店",
                  tags: ["住宿"],
                  nav: "Hotel Nikko Fukuoka"
                },
                {
                  type: "food",
                  title: "晚餐：福岡市區自理",
                  tags: ["餐食"],
                }, 
              ]
            },
            {
              id: 8,
              date: "12/31 (三)",
              location: "福岡 → 台北",
              weather: { temp: "5°C - 11°C", icon: "CloudSun", desc: "晴時多雲" },
              items: [ 
                {
                  type: "transport",
                  time: "9:00",
                  title: "博多巴士總站 → 太宰府天滿宮",
                  desc: "太宰府定期巴士旅人號",
                  tips: "直達約 45 分，班次密集，無需預約。可刷信用卡或IC卡。",
                  tags: ["交通"],
                  nav: "博多巴士總站"
                },
                {
                  type: "sight",
                  title: "太宰府天滿宮",
                  desc: "學問、文化及藝術之神",
                  tips: "全年無休，開放時間：6:30-18:30(冬季)。推薦：梅枝餅、星巴克太宰府天滿宮表參道店。",
                  tags: ["考生必去", "景點"],
                  image: "dazaifutenmangu.webp",
                  imageDesc: "太宰府天滿宮的主祭神是菅原道真，又名「天神」，即學問、文化及藝術之神。太宰府天滿宮是日本最重要的神社之一，也是全國12,000座天滿宮的總本社。作為福岡知名的旅遊勝地，神社每年吸引超過千萬名遊客造訪。",
                  nav: "Dazaifu Tenmangu"
                },
                {
                  type: "food",
                  title: "午餐：一蘭 太宰府參道店",
                  desc: "太宰府參道店限定「合格拉麵」",
                  image: "1ran.webp",
                  imageDesc: "全球唯一的五角形合格碗上有象徵太宰府的梅花紋，兩側則有五角形的合格繪馬。日文中「五角（Gokaku）」和「合格（Goukaku）」諧音，象徵考試通過的好兆頭。",
                  tips: "建議先去抽號碼牌。",
                  tags: ["餐食"],
                  nav: "一蘭 太宰府參道店",
                },
                {
                  type: "transport",
                  time: "14:00",
                  title: "太宰府天滿宮 → 博多",
                  desc: "太宰府定期巴士旅人號",
                  tips: "直達約 45 分，無需預約。",
                  tags: ["交通"],
                  nav: "博多巴士總站"
                },
                {
                  type: "transport",
                  time: "15:30",
                  title: "回飯店拿行李前往福岡機場",
                  tags: ["交通"],
                  tips: "地鐵 5 分鐘抵達「博多站」，轉乘機場免費接駁巴士至國內線航廈 或 搭乘計程車約 15 分鐘直達機場。",
                  nav: "Fukuoka Airport"
                },
                {
                  type: "transport",
                  time: "19:10 - 20:50",
                  title: "福岡 → 台北",
                  desc: "星宇航空 JX841 (2小時40分)",
                  highlight: "回程航班",
                  tags: ["交通"],
                  nav: "Fukuoka Airport International Terminal"
                }
              ]
            }
          ],
          flights: [
            { num: "JX840", route: "TPE 14:45 → FUK 18:00", date: "12/24" },
            { num: "JX841", route: "FUK 19:10 → TPE 20:50", date: "12/31" }
          ],
          hotels: [
            { name: "福岡日航飯店", night: "Day 1, 6, 7", loc: "福岡", tel: "+81-92-482-1111" },
            { name: "山莊無量塔", night: "Day 2", loc: "由布院", tel: "+81-977-84-5000" },
            { name: "壽花之庄", night: "Day 3", loc: "由布院", tel: "+81-977-84-2161" },
            { name: "黑川溫泉 奧之湯", night: "Day 4", loc: "黑川溫泉", tel: "+81-967-44-0021" },
            { name: "REF Kumamoto by VESSEL HOTELS", night: "Day 5", loc: "熊本", tel: "+81-096-328-7777" },
          ],
          emergency: [
            { name: "警察局", tel: "110" },
            { name: "火警/救護車", tel: "119" },
            { name: "台北駐日代表處(福岡)", tel: "+81-92-734-2810" },
            { name: "海外緊急救援", tel: "+886-800-085-095" }
          ]
        };

        // --- Components ---

        const WeatherBadge = ({ weather }) => (
            <div className="flex items-center gap-1.5 text-xs text-stone-500 bg-stone-100 px-2 py-1 rounded-full">
                {weather.icon === 'Snow' ? <Icons.Snow className="w-3 h-3 text-blue-400" /> : <Icons.CloudSun className="w-3 h-3 text-amber-500" />}
                <span>{weather.temp}</span>
                <span className="hidden sm:inline">· {weather.desc}</span>
            </div>
        );

        const Tag = ({ children, color = "stone" }) => {
            const colors = {
                stone: "bg-stone-100 text-stone-600",
                red: "bg-red-50 text-red-600 border border-red-100 font-medium",
                amber: "bg-amber-50 text-amber-700 border border-amber-100",
                indigo: "bg-indigo-50 text-indigo-700",
            };
            return (
                <span className={`text-[10px] px-2 py-0.5 rounded-md ${colors[color] || colors.stone} mr-1.5`}>{children}</span>
            );
        };

        const DayCard = ({ day, isExpanded, onToggle, id }) => {
            return (
                <div id={id} className="bg-white rounded-xl shadow-sm border border-stone-100 overflow-hidden mb-4 transition-all duration-300">
                    <div onClick={onToggle} className="p-4 flex items-center justify-between cursor-pointer active:bg-stone-50">
                        <div className="flex flex-col items-start">
                            <div className="flex items-center gap-2 mb-1">
                              <span className="font-bold text-lg text-stone-800">Day {day.id}</span>
                            </div>
                            <div className="flex items-center gap-2 mb-1">
                                <span className="text-sm text-stone-500 font-medium">{day.date} · {day.location} </span>
                            </div>
                            <WeatherBadge weather={day.weather} />
                        </div>
                        <div className="text-stone-300">
                            {isExpanded ? <Icons.ChevronUp size={20} /> : <Icons.ChevronDown size={20} />}
                        </div>
                    </div>

                    {isExpanded && (
                        <div className="border-t border-stone-100 bg-stone-50/30">
                            <div className="p-2 space-y-3">
                                {day.items.map((item, idx) => (
                                    <div key={idx} className="relative pl-4 pb-2 border-l-2 border-stone-200 ml-2 last:border-0 last:pb-0">
                                        <div className={`absolute -left-[9px] top-0 w-4 h-4 rounded-full border-2 border-white ${item.type === 'food' ? 'bg-amber-400' : item.type === 'transport' ? 'bg-indigo-400' : item.type === 'hotel' ? 'bg-stone-400' : 'bg-emerald-400'}`}></div>
                                        <div className="bg-white p-3 rounded-lg border border-stone-100 shadow-sm ml-2">
                                            <div className="flex justify-between items-start mb-1">
                                                <div className="flex flex-col">
                                                    {item.time && <span className="text-xs font-mono text-stone-400 mb-0.5">{item.time}</span>}
                                                    <h4 className="font-bold text-stone-800 text-sm md:text-base flex items-center gap-2">
                                                        {item.title}
                                                        {item.highlight && <Tag color="red">{item.highlight}</Tag>}
                                                    </h4>
                                                </div>
                                                {item.nav && (
                                                    <button 
                                                        onClick={(e) => { e.stopPropagation(); window.open(`https://www.google.com/maps/search/?api=1&query=${encodeURIComponent(item.nav)}`, '_blank'); }}
                                                        className="p-1.5 bg-blue-50 text-blue-600 rounded-full hover:bg-blue-100 transition-colors"
                                                    >
                                                        <Icons.Navigation size={14} />
                                                    </button>
                                                )}
                                            </div>
                                            <p className="text-xs text-stone-500 mb-2 whitespace-pre-line">{item.desc}</p>
                                            {item.tags && (
                                                <div className="flex flex-wrap gap-y-1 mb-2">
                                                    {item.tags.map(tag => (
                                                        <Tag key={tag} color={tag.includes("預約") ? "red" : tag.includes("必") ? "amber" : "stone"}>{tag}</Tag>
                                                    ))}
                                                </div>
                                            )}
                                            {item.image && (
                                              <div>
                                                <img className="mb-2" src={item.image}/>
                                                <p className="text-xs text-stone-500 mb-2 whitespace-pre-line">{item.imageDesc}</p>
                                              </div>
                                            )}
                                            {item.tips && (
                                                <div className="mt-2 text-xs bg-stone-50 p-2 rounded text-stone-600 italic border-l-2 border-amber-200">
                                                    <span className="font-bold not-italic mr-1 text-amber-600">Tip:</span>
                                                    <span dangerouslySetInnerHTML={{ __html: item.tips }} />
                                                </div>
                                            )}
                                        </div>
                                    </div>
                                ))}
                            </div>
                        </div>
                    )}
                </div>
            );
        };

        const InfoSection = () => (
            <div className="space-y-6 p-4 pb-24">
                <div className="bg-white p-5 rounded-2xl shadow-sm border border-stone-100">
                    <h3 className="flex items-center gap-2 font-bold text-stone-800 mb-4 border-b border-stone-100 pb-2"><Icons.Plane size={18} className="text-indigo-500" /> 航班資訊</h3>
                    <div className="space-y-3">
                        {tripData.flights.map((f, i) => (
                            <div key={i} className="flex justify-between items-center text-sm">
                                <div><div className="font-bold text-stone-700">{f.num}</div><div className="text-stone-500 text-xs">{f.date}</div></div>
                                <div className="font-mono text-stone-600">{f.route}</div>
                            </div>
                        ))}
                    </div>
                </div>
                <div className="bg-white p-5 rounded-2xl shadow-sm border border-stone-100">
                    <h3 className="flex items-center gap-2 font-bold text-stone-800 mb-4 border-b border-stone-100 pb-2"><Icons.Hotel size={18} className="text-emerald-500" /> 住宿列表</h3>
                    <div className="space-y-4">
                        {tripData.hotels.map((h, i) => (
                            <div key={i} className="flex flex-col text-sm border-l-2 border-stone-200 pl-3">
                                <div className="flex justify-between items-start">
                                    <div>
                                      <span className="font-bold text-stone-800 mr-2">{h.name}</span>
                                      <span className="text-xs bg-stone-100 px-2 py-0.5 rounded text-stone-500">{h.loc}</span>                              
                                    </div>
                                    <button 
                                        onClick={(e) => { e.stopPropagation(); window.open(`https://www.google.com/maps/search/?api=1&query=${encodeURIComponent(h.name)}`, '_blank'); }}
                                        className="p-1.5 bg-blue-50 text-blue-600 rounded-full hover:bg-blue-100 transition-colors"
                                    >
                                        <Icons.Navigation size={14} />
                                    </button>
                                </div>
                                <div className="text-stone-400 text-xs mb-1">{h.night}</div>
                                <a href={`tel:${h.tel}`} className="flex items-center gap-1 text-stone-500 text-xs mt-1 hover:text-blue-500"><Icons.Phone size={10} /> {h.tel}</a>
                            </div>
                        ))}
                    </div>
                </div>
                <div className="bg-white p-5 rounded-2xl shadow-sm border border-red-50">
                    <h3 className="flex items-center gap-2 font-bold text-red-700 mb-4 border-b border-red-50 pb-2"><Icons.Info size={18} /> 緊急聯絡</h3>
                    <div className="grid grid-cols-2 gap-3">
                        {tripData.emergency.map((e, i) => (
                            <a key={i} href={`tel:${e.tel}`} className="flex flex-col p-3 bg-red-50/50 rounded-lg active:bg-red-100 transition-colors">
                                <span className="text-xs text-red-500 mb-1">{e.name}</span>
                                <span className="font-mono font-bold text-red-700">{e.tel}</span>
                            </a>
                        ))}
                    </div>
                </div>
            </div>
        );

        const BudgetCalculator = () => {
            const [items, setItems] = useState([]);
            const [name, setName] = useState('');
            const [cost, setCost] = useState('');
            const add = () => { if (!name || !cost) return; setItems([...items, { id: Date.now(), name, cost: parseInt(cost) }]); setName(''); setCost(''); };
            const remove = (id) => setItems(items.filter(i => i.id !== id));
            const total = items.reduce((sum, i) => sum + i.cost, 0);

            return (
                <div className="p-4 pb-24 space-y-4">
                    <div className="bg-gradient-to-br from-stone-800 to-stone-700 p-6 rounded-2xl text-white shadow-lg">
                        <h3 className="text-stone-300 text-sm font-medium mb-1">目前總花費 (JPY)</h3>
                        <div className="text-4xl font-bold font-mono">¥{total.toLocaleString()}</div>
                    </div>
                    <div className="bg-white p-4 rounded-xl shadow-sm border border-stone-100">
                        <div className="flex gap-2 mb-4">
                            <input value={name} onChange={(e) => setName(e.target.value)} placeholder="項目" className="flex-1 bg-stone-50 border-none rounded-lg px-3 py-2 text-sm focus:ring-2 focus:ring-stone-200" />
                            <input type="number" value={cost} onChange={(e) => setCost(e.target.value)} placeholder="金額" className="w-24 bg-stone-50 border-none rounded-lg px-3 py-2 text-sm font-mono focus:ring-2 focus:ring-stone-200" />
                            <button onClick={add} className="bg-stone-800 text-white p-2 rounded-lg active:scale-95 transition-transform"><Icons.Plus size={20} /></button>
                        </div>
                        <div className="space-y-2">
                            {items.length === 0 && <div className="text-center text-stone-300 py-4 text-sm">暫無記帳資料</div>}
                            {items.map(item => (
                                <div key={item.id} className="flex justify-between items-center p-3 bg-stone-50 rounded-lg group">
                                    <span className="text-stone-700 text-sm">{item.name}</span>
                                    <div className="flex items-center gap-3">
                                        <span className="font-mono text-stone-600">¥{item.cost.toLocaleString()}</span>
                                        <button onClick={() => remove(item.id)} className="text-stone-300 hover:text-red-400"><Icons.Trash2 size={16} /></button>
                                    </div>
                                </div>
                            ))}
                        </div>
                    </div>
                </div>
            );
        };

        const DateNavigation = ({ days, activeDayId, scrollToDay }) => {
            return (
                // 設置 top-[62px] 以避開 sticky header
                <div className="sticky top-[62px] z-10 bg-white/95 backdrop-blur-sm border-b border-stone-100 shadow-sm overflow-x-auto whitespace-nowrap scrollbar-hide">
                    <div className="flex px-4">
                        {days.map((day) => (
                            <button
                                key={day.id}
                                onClick={() => scrollToDay(day.id)}
                                className={`flex flex-col items-center flex-shrink-0 px-4 py-2 text-sm font-medium transition-colors duration-200 border-b-4 
                                    ${activeDayId === day.id
                                        ? 'text-amber-600 border-amber-400'
                                        : 'text-stone-500 border-transparent hover:text-stone-700'
                                    }`}
                            >
                                <span className="mt-1 mb-1 text-sm font-bold">{day.date.split('(')[0]}</span>
                                <span className="text-xs">週{day.date.split("(")[1].split(")")[0]}</span>
                            </button>
                        ))}
                    </div>
                </div>
            );
        };

        // --- 滾動到頂部按鈕組件 ---
        const ScrollToTopButton = () => {
            // 滾動到頁面頂端
            const scrollToTop = () => {
                window.scrollTo({
                    top: 0,
                    behavior: 'smooth'
                });
            };

            // 將按鈕包裹在一個固定且全寬的 div 中，然後利用 max-w-md mx-auto 居中對齊
            // fixed bottom-24 inset-x-0 確保按鈕固定在螢幕底部中央。
            return (
                <div className="fixed bottom-32 inset-x-0 z-40">
                    <div className="max-w-md mx-auto relative h-0"> {/* h-0 避免佔用空間，relative 讓按鈕可以絕對定位 */}
                        <button
                            onClick={scrollToTop}
                            // 使用 absolute 定位在 max-w-md 容器的右側，right-6 保留邊距
                            className="absolute right-6 p-3 bg-sky-500 text-white rounded-full shadow-lg hover:bg-sky-600 transition-all duration-300 transform hover:scale-105"
                            aria-label="回到頁面頂端"
                        >
                            <Icons.ChevronUp size={24} strokeWidth={2.5} />
                        </button>
                    </div>
                </div>
            );
        };

        // --- Main App ---
        function App() {
            const [activeTab, setActiveTab] = useState('itinerary');
            const [expandedDay, setExpandedDay] = useState(new Set(tripData.days.map((day) => day.id)));
            const [activeDayId, setActiveDayId] = useState(1); // 新增狀態：追蹤目前點擊的日期 ID

            // 捲動至指定 DayCard 的函式
            const scrollToDay = (dayId) => {
                setActiveDayId(dayId); // 更新狀態以高亮顯示
                const element = document.getElementById(`day-${dayId}`);
                if (element) {
                    // 估計 Header + DateNav 的高度 (大約 62px + 50px)
                    const OFFSET = 110;
                    
                    // 計算元素在頁面中的絕對位置
                    const elementPosition = element.getBoundingClientRect().top + window.scrollY;
                    
                    // 平滑捲動
                    window.scrollTo({
                        top: elementPosition - OFFSET,
                        behavior: 'smooth'
                    });
                }
            };

            return (
                <div className="min-h-screen bg-[#FDFCF8] text-stone-800 font-sans max-w-md mx-auto relative shadow-2xl overflow-hidden">
                    <header className="sticky top-0 z-20 bg-[#FDFCF8]/90 backdrop-blur-md border-b border-stone-100 px-6 py-4 flex justify-between items-end">
                        <div>
                          <h1 className="text-xl font-bold tracking-tight text-stone-900">{tripData.meta.title}</h1>
                          <p className="text-xs text-stone-500 font-medium mt-0.5 tracking-wide"></p>
                        </div>
                    </header>
                    <main className="min-h-screen">
                        {activeTab === 'itinerary' && (
                          <>
                            <DateNavigation 
                              days={tripData.days} 
                              activeDayId={activeDayId}
                              scrollToDay={scrollToDay} 
                            />
                            <div className="p-4 pb-24 animate-fade-in">
                                {tripData.days.map((day) => (
                                    <DayCard 
                                      key={day.id}
                                      id={`day-${day.id}`} // 傳遞 ID 給 DayCard 
                                      day={day} 
                                      isExpanded={expandedDay.has(day.id)} 
                                      onToggle={() => setExpandedDay((prevExpanded) => {
                                        const newExpanded = new Set(prevExpanded);
                                        newExpanded.has(day.id) ? newExpanded.delete(day.id) : newExpanded.add(day.id);
                                        return newExpanded;
                                      }
                                    )} />
                                ))}
                            </div>
                          </>
                        )}
                        {activeTab === 'info' && <InfoSection />}
                        {activeTab === 'budget' && <BudgetCalculator />}
                    </main>
                    {/* 回到頂部按鈕 */}
                    <ScrollToTopButton />

                    <nav className="fixed bottom-0 left-0 right-0 max-w-md mx-auto bg-white border-t border-stone-200 px-3 flex justify-between items-center z-30 pb-safe">
                        <button onClick={() => setActiveTab('itinerary')} className={`flex flex-col items-center gap-1 py-3 px-6 transition-colors ${activeTab === 'itinerary' ? 'text-stone-900' : 'text-stone-400'}`}>
                            <Icons.Calendar size={20} strokeWidth={activeTab === 'itinerary' ? 2.5 : 2} /><span className="text-[10px] font-medium">行程</span>
                        </button>
                        <button onClick={() => setActiveTab('info')} className={`flex flex-col items-center gap-1 py-3 px-6 transition-colors ${activeTab === 'info' ? 'text-stone-900' : 'text-stone-400'}`}>
                            <Icons.Hotel size={20} strokeWidth={activeTab === 'info' ? 2.5 : 2} /><span className="text-[10px] font-medium">資訊</span>
                        </button>
                        <button onClick={() => setActiveTab('budget')} className={`flex flex-col items-center gap-1 py-3 px-6 transition-colors ${activeTab === 'budget' ? 'text-stone-900' : 'text-stone-400'}`}>
                            <Icons.Wallet size={20} strokeWidth={activeTab === 'budget' ? 2.5 : 2} /><span className="text-[10px] font-medium">記帳</span>
                        </button>
                    </nav>
                </div>
            );
        }

        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<App />);

        if ('serviceWorker' in navigator) {
          // 等待整個頁面和資源載入完成
          window.addEventListener('load', () => {
              // navigator.serviceWorker.register() 是註冊 Service Worker 的核心 API
              // './service-worker.js' 是 Service Worker 檔案的路徑
              navigator.serviceWorker.register('./service-worker.js')
                  .then(registration => {
                      console.log('Service Worker 註冊成功: ', registration.scope);
                  })
                  .catch(err => {
                      console.log('Service Worker 註冊失敗: ', err);
                  });
          });
        }
    </script>
</body>
</html>